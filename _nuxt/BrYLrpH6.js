import{b as U,d as z,m as E,t as J,P as W,Q as q,M as A,a as G,N as K,_ as Q,O as j}from"./BILdiH8x.js";import{h as R,r as p,f as X,l as Y,b as P,q as Z,I as ee,D,J as ae,c as F,w as I,a as m,t as C,G as k,F as H,o as N,E as te,H as se}from"./fGEXg0dD.js";import{_ as ne}from"./DlAUqK2U.js";import"./HMHojlja.js";var oe=(n,o,l)=>new Promise((v,u)=>{var f=d=>{try{y(l.next(d))}catch(c){u(c)}},i=d=>{try{y(l.throw(d))}catch(c){u(c)}},y=d=>d.done?v(d.value):Promise.resolve(d.value).then(f,i);y((l=l.apply(n,o)).next())});const le={top:E(10),rows:E(4),duration:E(4e3),autoPlay:J,delay:W(300),modelValue:q()},[ie,M]=U("barrage");var de=R({name:ie,props:le,emits:["update:modelValue"],setup(n,{emit:o,slots:l}){const v=p(),u=M("item"),f=p(0),i=[],y=(t,r=n.delay)=>{const e=document.createElement("span");return e.className=u,e.innerText=String(t),e.style.animationDuration=`${n.duration}ms`,e.style.animationDelay=`${r}ms`,e.style.animationName="van-barrage",e.style.animationTimingFunction="linear",e},d=p(!0),c=p(n.autoPlay),g=({id:t,text:r},e)=>{var a;const s=y(r,d.value?e*n.delay:void 0);!n.autoPlay&&c.value===!1&&(s.style.animationPlayState="paused"),(a=v.value)==null||a.append(s),f.value++;const b=(f.value-1)%+n.rows*s.offsetHeight+ +n.top;s.style.top=`${b}px`,s.dataset.id=String(t),i.push(s),s.addEventListener("animationend",()=>{o("update:modelValue",[...n.modelValue].filter(w=>String(w.id)!==s.dataset.id))})},h=(t,r)=>{const e=new Map(r.map(a=>[a.id,a]));t.forEach((a,s)=>{e.has(a.id)?e.delete(a.id):g(a,s)}),e.forEach(a=>{const s=i.findIndex(b=>b.dataset.id===String(a.id));s>-1&&(i[s].remove(),i.splice(s,1))}),d.value=!1};X(()=>n.modelValue.slice(),(t,r)=>h(t??[],r??[]),{deep:!0});const x=p({});return Y(()=>oe(this,null,function*(){var t;x.value["--move-distance"]=`-${(t=v.value)==null?void 0:t.offsetWidth}px`,yield Z(),h(n.modelValue,[])})),z({play:()=>{c.value=!0,i.forEach(t=>{t.style.animationPlayState="running"})},pause:()=>{c.value=!1,i.forEach(t=>{t.style.animationPlayState="paused"})}}),()=>{var t;return P("div",{class:M(),ref:v,style:x.value},[(t=l.default)==null?void 0:t.call(l)])}}});const re=["poster"],ue={class:"info"},ce={class:"title-text"},me={class:"body"},pe={class:"author"},_e=["src"],ve={class:"name"},fe={class:"relate"},ye={class:"relate-list"},he=R({__name:"[id]",async setup(n){var r;let o,l;const{params:v}=ee(),{data:u}=([o,l]=D(()=>A(`/api/video/${v.id}`,"$JF3LIOKm8C")),o=await o,l(),o),f=p([{id:100,text:"轻量"},{id:101,text:"可定制的"},{id:102,text:"移动端"},{id:103,text:"Vue"},{id:104,text:"组件库"},{id:105,text:"VantUI"},{id:106,text:"666"}]),i=p();ae({title:((r=u.value)==null?void 0:r.title)+" - 哔哩哔哩 (゜-゜)つロ 干杯~-bilibili官方"});const y=()=>{var e;(e=i.value)==null||e.play()},d=()=>{var e;(e=i.value)==null||e.pause()},{data:c}=([o,l]=D(()=>A("/api/video","$LdkDz8HEiO")),o=await o,l(),o),g=p([]),h=p(!1),x=p(!1);let V=1,S=10;const t=()=>{var a,s;h.value=!1;const e=(a=c.value)==null?void 0:a.slice((V-1)*S,V*S);g.value.push(...e),V++,((s=c.value)==null?void 0:s.length)===g.value.length&&(x.value=!0)};return(e,a)=>{var $,B,L;const s=Q,b=de,w=G,O=j,T=K;return N(),F(H,null,[P(w,null,{default:I(()=>[P(s),P(b,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=_=>f.value=_),"auto-play":!1,ref_key:"barrageRef",ref:i},{default:I(()=>{var _;return[m("video",{controls:"",class:"video-play",ref:"videoRef",poster:(_=k(u))==null?void 0:_.pic,onPlay:y,onPause:d,src:"https://video.pearvideo.com/mp4/third/20230706/cont-1784445-12033417-151259-hd.mp4"},null,40,re)]}),_:1},8,["modelValue"])]),_:1}),m("div",ue,[m("h1",ce,C(($=k(u))==null?void 0:$.title),1),m("div",me,[m("div",pe,[m("img",{class:"avatar",src:(B=k(u))==null?void 0:B.author.face},null,8,_e),m("span",ve,C((L=k(u))==null?void 0:L.author.name),1)])])]),m("div",fe,[a[2]||(a[2]=m("h3",{class:"relate-title"},"相关推荐",-1)),P(T,{loading:h.value,"onUpdate:loading":a[1]||(a[1]=_=>h.value=_),finished:x.value,"finished-text":"去bilibili App看更多",onLoad:t},{default:I(()=>[m("div",ye,[(N(!0),F(H,null,te(g.value,_=>(N(),se(O,{key:_.aid,item:_},null,8,["item"]))),128))])]),_:1},8,["loading","finished"])])],64)}}}),Ve=ne(he,[["__scopeId","data-v-eac7d6ed"]]);export{Ve as default};
